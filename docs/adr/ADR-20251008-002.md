# ADR 002: RBAC Choice â€” Spatie Laravel Permission

**Date**: 2025-10-08  
**Status**: Accepted  
**Decision Makers**: Development Team  

## Context

The application requires a comprehensive Role-Based Access Control (RBAC) system that supports:
- Multiple user roles (super_admin, admin, lawyer, staff, client_portal)
- Granular permissions for domain entities (cases, hearings, documents, clients, etc.)
- Role-permission assignment and checking
- Model-level and route-level authorization
- Database-backed permission storage
- Integration with Laravel's authorization system (Gates/Policies)

## Decision

We will use **Spatie Laravel Permission** package for RBAC implementation.

## Rationale

1. **Industry Standard**: Most widely adopted RBAC package in Laravel ecosystem
2. **Feature Complete**: Supports roles, permissions, role-permission assignment, direct permission assignment
3. **Performance**: Caches permissions efficiently, minimizing database queries
4. **Laravel Integration**: Works seamlessly with Laravel's Gate and Policy systems
5. **Flexibility**: Supports guard-specific permissions, multiple models
6. **Well Maintained**: Active development, regular updates, comprehensive documentation
7. **Testing**: Extensively tested and battle-proven in production

## Consequences

### Positive
- Rapid implementation of complex permission structures
- Helper methods (`hasRole()`, `hasPermission()`, `can()`) simplify authorization checks
- Middleware for route protection
- Blade directives for view-level permission checks
- Migration-based permission seeding
- Supports permission inheritance via roles

### Negative
- Adds database tables (`roles`, `permissions`, `model_has_roles`, etc.)
- Requires cache clearing when permissions change
- Slightly increased query complexity for permission checks

## Implementation Notes

- Permissions will follow dot notation: `{entity}.{action}` (e.g., `cases.view`, `cases.edit`)
- Super admin role will receive all permissions by default
- Policies will leverage Spatie's permission checks
- Permission seeder will be version-controlled for consistency

## Alternatives Considered

1. **Custom RBAC**: More work, potential bugs, no community support
2. **Laravel's Built-in Gates/Policies Only**: Too basic, lacks role management
3. **Other Packages** (Bouncer, Laratrust): Less adoption, similar features

## References

- Spatie Permission Documentation: https://spatie.be/docs/laravel-permission
- Project Requirements: Master Prompt T-02, T-03, NFRs (Security)

